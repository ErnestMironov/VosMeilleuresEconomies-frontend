(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0deb02"],{"875b":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"text-tgreen bg-white min-h-tmminbody sm:min-h-tminbody p-5 sm:p-10 w-full flex flex-col items-center justify-center"},[s("h1",{staticClass:"font-bold w-full sm:w-8/12 mb-2 sm:mb-3 text-center"},[e._v(" Merci de compléter votre dossier ")]),s("div",{staticClass:"w-full sm:w-11/12 xl:w-6/12 sm:py-2 sm:px-5"},[s("div",{staticClass:"grid grid-cols-12 gap-x-2 gap-y-3 items-center w-full"},[s("div",{class:e.labelClass},[e._v("Nom")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.lastName,expression:"lastName"}],class:e.inputClass,attrs:{placeholder:"votre nom"},domProps:{value:e.lastName},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.register(t)},input:function(t){t.target.composing||(e.lastName=t.target.value)}}}),s("div",{class:e.hspacer}),s("div",{class:e.labelClass},[e._v("Prénom")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.firstName,expression:"firstName"}],class:e.inputClass,attrs:{placeholder:"votre prénom"},domProps:{value:e.firstName},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.register(t)},input:function(t){t.target.composing||(e.firstName=t.target.value)}}}),s("p",{class:e.hspacer}),s("div",{class:e.labelClass},[e._v("Téléphone")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone"}],class:e.inputClass,attrs:{placeholder:"votre téléphone"},domProps:{value:e.phone},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.register(t)},input:function(t){t.target.composing||(e.phone=t.target.value)}}}),s("p",{class:e.hspacer}),s("div",{class:e.labelClass},[e._v("Email")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],class:e.inputClass,attrs:{placeholder:"votre email"},domProps:{value:e.email},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.register(t)},input:function(t){t.target.composing||(e.email=t.target.value)}}}),s("p",{class:e.hspacer}),s("div",{class:e.labelClass},[e._v("N° Sécurité Social")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.noSecuriteSociale,expression:"noSecuriteSociale"}],class:e.inputClass,attrs:{placeholder:"votre N° Sécu. Social"},domProps:{value:e.noSecuriteSociale},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.register(t)},input:function(t){t.target.composing||(e.noSecuriteSociale=t.target.value)}}}),s("p",{class:e.hspacer}),s("div",{class:e.labelClass},[e._v("Justificatif de droits")]),s("div",{class:[e.selectContainerClass,"relative"]},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.justificatiDroitSlugTitre,expression:"justificatiDroitSlugTitre"}],class:[e.selectClass,"t_sm-selector"],attrs:{id:"securite-option-select"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.justificatiDroitSlugTitre=t.target.multiple?s:s[0]}}},e._l(e.justificatifDroitOptions,(function(t){return s("option",{key:t.text,staticClass:"w-full",domProps:{value:t.val}},[e._v(" "+e._s(t.text)+" ")])})),0),s("i",{class:["feather icon-chevron-down flex items-center text-lg absolute right-2.5 inset-y-0"]})]),s("p",{class:e.hspacer}),s("div",{class:e.labelClass}),s("div",{staticClass:"col-span-7 sm:col-span-6 flex flex-col items-center justify-center"},[e.justificatiDroitSlugTitre?s("button",{class:e.uploadBtnClass,on:{click:function(t){return t.preventDefault(),e.chooseFile(e.justificatiDroitSlugTitre)}}},[e.uploadLoading?s("p",{staticClass:"text-xl animate-spin feather icon-loader mr-2"}):e._e(),s("i",{staticClass:"feather icon-upload mr-1"}),e._v("Selectioner un fichier ")]):e._e(),e.file?s("p",[e._v(e._s(e.file.name))]):e._e()]),s("p",{class:e.hspacer}),s("div",{class:e.labelClass},[e._v("Adresse")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.street,expression:"street"}],class:e.inputClass,attrs:{placeholder:"N°, rue, avenue, boulevard.."},domProps:{value:e.street},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.register(t)},input:function(t){t.target.composing||(e.street=t.target.value)}}}),s("p",{class:e.hspacer}),s("div",{class:e.labelClass}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.zipcode,expression:"zipcode"}],class:e.inputClass,attrs:{placeholder:"votre code postal"},domProps:{value:e.zipcode},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.register(t)},input:function(t){t.target.composing||(e.zipcode=t.target.value)}}}),s("p",{class:e.hspacer}),s("div",{class:e.labelClass}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.city,expression:"city"}],class:e.inputClass,attrs:{placeholder:"votre ville"},domProps:{value:e.city},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.register(t)},input:function(t){t.target.composing||(e.city=t.target.value)}}}),s("p",{class:e.hspacer})]),s("div",{staticClass:"grid grid-cols-12 gap-x-2 gap-y-3 mt-3 sm:mt-5 items-center w-full"},[s("div",{class:e.labelClass},[e._v("Code de vérification")]),s("div",{class:[e.inputCaptchaContainerClass,"flex flex-col justify-start items-start md:flex-row md:justify-start md:items-center "]},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.captcha,expression:"captcha"}],class:[e.inputCaptchaClass,"mb-1 py-1 w-full md:w-4/12 mr-0 sm:mr-2"],attrs:{placeholder:"code"},domProps:{value:e.captcha},on:{input:function(t){t.target.composing||(e.captcha=t.target.value)}}}),s("div",{staticClass:"flex items-center"},[s("div",{staticClass:"text-sm w-18",domProps:{innerHTML:e._s(e.svgCaptcha)}}),s("i",{staticClass:"w-2/12 ml-2 cursor-pointer hspacer feather icon-refresh-cw",on:{click:function(t){return e.getCaptcha()}}})])]),s("p",{class:e.hspacer})]),s("div",{staticClass:"flex flex-col items-center justify-center w-full"},[e.errors.length?s("ul",{staticClass:"w-8/12 mx-auto text-center p-2 text-tdanger"},e._l(e.errors,(function(t,i){return s("li",{key:i},[s("i",{staticClass:"feather icon-alert-triangle mr-1"}),e._v(e._s(t))])})),0):e._e(),e.errormessage?s("p",{staticClass:"p-2 text-tdanger"},[s("i",{staticClass:"feather icon-alert-triangle mr-1"}),e._v(e._s(e.errormessage))]):e._e(),e.message?s("p",{staticClass:"p-2 text-success"},[s("i",{staticClass:"feather icon-check mr-1"}),e._v(e._s(e.message))]):e._e()]),s("div",{staticClass:"grid grid-cols-12 gap-x-2 gap-y-3 mt-3 sm:mt-5 items-center w-full"},[s("div",{class:e.labelClass}),s("button",{class:[e.inputClass,"bg-tdarkblue font-bold text-white px-1 py-2 hover:shadow-xl flex justify-center items-center"],on:{click:e.register}},[e.loading?s("p",{staticClass:"text-xl animate-spin feather icon-loader mr-2"}):e._e(),s("p",[e._v("Mise à jour")])]),s("p",{class:e.hspacer})])]),s("input",{ref:"fileInput",staticStyle:{height:"1px",width:"1px",overflow:"hidden","margin-left":"-99999px",position:"absolute"},attrs:{type:"file",id:"input",name:"input",accept:"image/*, .pdf, .doc, .docx"},on:{change:e.onChange}})])},a=[],r=s("5530"),o=(s("4de4"),s("99af"),s("3418")),n=s("6b64"),l={name:"Register",data:function(){return{hspacer:"col-span-1 sm:col-span-3",labelClass:"col-span-4 sm:col-span-3 md:col-span-3 text-right",uploadBtnClass:"\n                border rounded-3xl hover:shadow-xl\n                py-2 px-3 sm:px-5 mb-2 sm:mb-0\n                bg-t_dark_green text-xs sm:text-sm text-white \n                flex justify-start items-center",selectContainerClass:"\n                col-span-7 \n                sm:col-span-6",selectClass:"\n                w-full\n                border border-gray-300 \n                px-2 py-2 sm:py-3 rounded-md \n                hover:shadow-md \n                text-sm xl:text-base",inputClass:"\n                col-span-7 \n                sm:col-span-6 \n                border border-gray-300 hover:shadow-md hover:border-blue-200 \n                px-2 py-1 sm:py-2 pr-5 \n                rounded-md",inputCaptchaContainerClass:"\n                col-span-7 \n                sm:col-span-6",inputCaptchaClass:"\n                border border-gray-300 hover:shadow-md hover:border-blue-200 \n                px-2 py-1 sm:py-2\n                rounded-md",errors:[],loading:!1,message:"",errormessage:"",phone:"",email:"",noSecuriteSociale:"",firstName:"",lastName:"",street:"",city:"",zipcode:"",title:"MEDIKA",justificatifDroitOptions:[{text:"Sélection document",val:""},{text:"Feuille d’accident de travail",val:"feuille_accident_de_travail"},{text:"Attestation CMU",val:"attestation_cmu"},{text:"Carte AME",val:"carte_ame"},{text:"ACS (Aide Complémentaire Santé)",val:"aide_de_complementaire_sante"},{text:"Je n'ai aucun fichier à envoyer",val:""}],file:"",uploadLoading:!1,justificatiDroitSlugTitre:"",svgCaptcha:null,captcha:""}},mounted:function(){this.getCaptcha()},computed:Object(r["a"])({},Object(o["mapState"])({dossier:function(e){return e.dossier.dossier}})),methods:Object(r["a"])(Object(r["a"])({},Object(o["mapActions"])({setDossier:function(e){return e.dossier.setDossier}})),{},{chooseFile:function(e){this.justificatiDroitSlugTitre=e,this.$refs.fileInput.click()},getTitle:function(e){return this.justificatifDroitOptions.filter((function(t){return t.val==e})).text},initMsg:function(){this.errors=[],this.uploadLoading=!1,this.loading=!1,this.message="",this.errormessage=""},getCaptcha:function(){var e=this;this.$myAuthAxios({url:"dossier/me/getCaptcha",method:"GET"}).then((function(t){e.svgCaptcha=t.data.data}))},onChange:function(){var e=this,t=this;if(this.initMsg(),this.uploadLoading=!0,this.file=this.$refs.fileInput.files[0],this.file){var s=new FormData;s.append("doc",this.file),this.$myAuthAxios({url:"/dossier/me/uploadJustificatifDroit?justificatiDroitSlugTitre=".concat(this.justificatiDroitSlugTitre),method:"PUT",data:s}).then((function(t){t.data&&(e.message=e.$message.send_ok())})).catch((function(t){e.errormessage=e.$error.upload_fail()})).then((function(){t.uploadLoading=""}))}},checkForm:function(){var e=this;return this.initMsg(),this.errors=[],this.firstName?this.firstName&&this.firstName.length>50&&this.errors.push(this.$error.max_length(50)):this.errors.push(this.$error.is_empty("Prénom")),this.lastName?this.lastName&&this.lastName.length>50&&this.errors.push(this.$error.max_length(50)):this.errors.push(this.$error.is_empty("Nom")),this.phone?this.phone&&this.phone.length>50&&this.inputCheckerrors.push(this.$error.max_length(50)):this.inputCheckerrors.push(this.$error.is_empty("Téléphone")),this.email?Object(n["f"])(this.email)||this.errors.push(e.$error.wrong_format("Email")):this.errors.push(e.$error.is_empty("Email")),this.noSecuriteSociale||this.errors.push(this.$error.is_empty("Numéro Sécurité Sociale")),this.street||this.errors.push(this.$error.is_empty("Rue")),this.city||this.errors.push(this.$error.is_empty("Ville")),this.zipcode||this.errors.push(this.$error.is_empty("Code postal")),this.justificatiDroitSlugTitre&&!this.file&&this.errors.push(this.$error.is_empty("fichier")),!this.errors.length},register:function(){var e=this;if(this.checkForm()){var t=this;this.loading=!0;var s=new Date,i=s.getFullYear(),a=s.getMonth()+1,r=s.getDate(),o=s.getHours(),n=s.getMinutes();a<10&&(a="0"+a),r<10&&(r="0"+a),o<10&&(o="0"+o),n<10&&(n="0"+n);var l="".concat(i,"/").concat(a,"/").concat(r,":").concat(o,":").concat(n),c={currentDate:l,firstName:t.firstName,lastName:t.lastName,phone:t.phone,email:t.email,captcha:t.captcha,"couvertureSante.noSecuriteSociale":t.noSecuriteSociale,address:{street:t.street,city:t.city,zipcode:t.zipcode,country:"France"}};t.justificatiDroitSlugTitre&&t.getTitle(t.justificatiDroitSlugTitre)&&Object.assign(c,{"couvertureSante.justificatiDroitTitre":t.getTitle(t.justificatiDroitSlugTitre),"couvertureSante.justificatiDroitSlugTitre":t.justificatiDroitSlugTitre}),this.$myAuthAxios({url:"/dossier/patient-register",method:"PUT",data:c}).then((function(e){if(e.data){t.message=t.$message.update_ok();var s=((e.data||{}).data||{}).dossier||{};t.setDossier(s._id),t.setDossier(s),t.$router.push({name:"dossier-dash"})}})).catch((function(s){s.data&&s.data.message?e.errormessage=s.data.message:t.errormessage=t.$error.update_fail()})).then((function(){t.loading=!1}))}}})},c=l,u=s("2877"),p=Object(u["a"])(c,i,a,!1,null,"0a624958",null);t["default"]=p.exports}}]);